{% load static %}
<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BookMyTurf | Browse Turfs</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400..700;1,400..700&display=swap"
    rel="stylesheet">

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <style>
        :root {
      --bg-dark: #1a1a1a;
      --bg-card: #242424;
      --bg-card2: #2e2e2e;
      --accent: #00bcd4;
      --accent-dark: #0097a7;
      --accent-glow: rgba(0, 188, 212, 0.25);
      --text-white: #ffffff;
      --text-muted: #a0a0a0;
      --text-sub: #cccccc;
      --border: rgba(0, 188, 212, 0.2);

      /* Mappings for older templates to not break completely initially */
      --bg-color: var(--bg-dark);
      --text-primary: var(--text-white);
      --text-secondary: var(--text-sub);
      --border-color: var(--border);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: 'Lora', serif;
      background-color: var(--bg-color);
      color: var(--text-primary);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    /* =======================
       HEADER (Shared style)
    ======================= */
    header {
      background-color: var(--text-primary);
      color: var(--bg-color);
      padding: 24px 60px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 2px solid var(--border-color);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    header a {
      color: var(--bg-color);
      text-decoration: none;
      transition: opacity 0.3s, text-decoration 0.3s;
    }

    header a:hover {
      opacity: 0.8;
      text-decoration: underline;
    }

    .site-title {
      font-size: 26px;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .nav-links {
      display: flex;
      gap: 30px;
      align-items: center;
      font-size: 16px;
    }

    .nav-links a.active {
      font-weight: 700;
      text-decoration: underline;
    }

    /* =======================
       LAYOUT: FILTERS + GRID
    ======================= */
    .container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 20px;
      flex: 1;
    }

    .page-title {
      font-size: 42px;
      font-weight: 700;
      margin-bottom: 10px;
      color: var(--text-primary);
      text-align: center;
    }

    .page-subtitle {
      text-align: center;
      font-size: 18px;
      margin-bottom: 40px;
    }

    .browse-grid {
      display: grid;
      grid-template-columns: 280px 1fr;
      gap: 30px;
      align-items: start;
    }

    /* Filter sidebar */
    .filters {
      position: sticky;
      top: 120px;
      border-radius: 8px;
      border: 1px solid var(--accent);
      background-color: rgba(85, 107, 47, 0.05);
      /* very light olive */
      box-shadow: 0 4px 15px rgba(85, 107, 47, 0.1);
      padding: 20px;
    }

    .filters h2 {
      font-size: 20px;
      margin-bottom: 20px;
      border-bottom: 1px solid var(--accent);
      padding-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .filter-group {
      margin-bottom: 20px;
    }

    .filter-group label {
      display: block;
      font-weight: 600;
      margin-bottom: 8px;
      font-size: 16px;
    }

    .filter-group select {
      width: 100%;
      padding: 10px;
      font-family: inherit;
      border: 1px solid var(--text-primary);
      border-radius: 4px;
      background-color: var(--bg-color);
      color: var(--text-primary);
      outline: none;
    }

    .filter-group select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 5px rgba(107, 142, 35, 0.5);
    }

    /* Range Slider Styling */
    .filter-group input[type="range"] {
      -webkit-appearance: none;
      appearance: none;
      width: 100%;
      background: transparent;
      margin: 10px 0;
    }

    .filter-group input[type="range"]::-webkit-slider-runnable-track {
      width: 100%;
      height: 6px;
      cursor: pointer;
      background: rgba(85, 107, 47, 0.3);
      /* Lighter Olive */
      border-radius: 3px;
    }

    .filter-group input[type="range"]::-webkit-slider-thumb {
      height: 18px;
      width: 18px;
      border-radius: 50%;
      background: var(--text-primary);
      /* Olive Green */
      cursor: pointer;
      -webkit-appearance: none;
      appearance: none;
      margin-top: -6px;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
    }

    .filter-group input[type="range"]::-moz-range-track {
      width: 100%;
      height: 6px;
      cursor: pointer;
      background: rgba(85, 107, 47, 0.3);
      border-radius: 3px;
    }

    .filter-group input[type="range"]::-moz-range-thumb {
      height: 18px;
      width: 18px;
      border-radius: 50%;
      background: var(--text-primary);
      cursor: pointer;
      border: none;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
    }

    .range-meta {
      display: flex;
      justify-content: space-between;
      margin-top: 8px;
      font-size: 14px;
      font-weight: 600;
    }

    .filter-actions {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .btn {
      padding: 10px 16px;
      border-radius: 4px;
      border: none;
      cursor: pointer;
      font-family: inherit;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.3s ease;
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .btn-apply {
      background-color: var(--text-primary);
      color: var(--bg-color);
    }

    .btn-apply:hover {
      background-color: var(--accent);
    }

    .btn-clear {
      background-color: transparent;
      color: var(--text-primary);
      border: 1px solid var(--text-primary);
    }

    .btn-clear:hover {
      background-color: rgba(85, 107, 47, 0.1);
    }

    /* =======================
       TURF LISTING AREA
    ======================= */
    .results-area {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .results-head {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-bottom: 10px;
      border-bottom: 1px solid var(--accent);
    }

    .results-head h3 {
      font-size: 22px;
    }

    .sort-control {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 600;
    }

    .sort-control select {
      padding: 8px;
      border: 1px solid var(--text-primary);
      border-radius: 4px;
      background: var(--bg-color);
      color: var(--text-primary);
      font-family: inherit;
    }

    .cards-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 24px;
    }

    /* Turf Card */
    .turf-card {
      background-color: var(--bg-color);
      border: 1px solid var(--accent);
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(85, 107, 47, 0.05);
      transition: transform 0.3s, box-shadow 0.3s;
      display: flex;
      flex-direction: column;
    }

    .turf-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(85, 107, 47, 0.15);
      border-color: var(--text-primary);
    }

    .turf-image-placeholder {
      height: 160px;
      background-color: rgba(85, 107, 47, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 40px;
      color: var(--accent);
      border-bottom: 1px solid var(--accent);
      position: relative;
    }

    .badge-rating {
      position: absolute;
      top: 10px;
      left: 10px;
      background-color: var(--text-primary);
      color: var(--bg-color);
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 13px;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .turf-details {
      padding: 20px;
      display: flex;
      flex-direction: column;
      flex: 1;
    }

    .turf-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 8px;
    }

    .turf-location {
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 6px;
      margin-bottom: 15px;
      opacity: 0.9;
    }

    .turf-price {
      font-size: 22px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 15px;
    }

    .turf-price span {
      font-size: 14px;
      font-weight: 400;
    }

    .facilities-list {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }

    .facility-icon {
      width: 32px;
      height: 32px;
      border-radius: 4px;
      background-color: rgba(85, 107, 47, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-primary);
      border: 1px solid var(--accent);
      font-size: 14px;
    }

    .card-actions {
      margin-top: auto;
      border-top: 1px solid var(--accent);
      padding-top: 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .btn-view {
      background-color: var(--bg-color);
      color: var(--text-primary);
      border: 1px solid var(--text-primary);
      padding: 8px 16px;
      text-decoration: none;
      font-weight: 600;
      border-radius: 4px;
      transition: auto 0.3s;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn-view:hover {
      background-color: var(--text-primary);
      color: var(--bg-color);
      text-decoration: none;
    }

    .load-more-container {
      margin-top: 30px;
      text-align: center;
    }

    .btn-load {
      background-color: var(--text-primary);
      color: var(--bg-color);
      padding: 12px 30px;
      font-size: 16px;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      border-radius: 4px;
      text-decoration: none;
      transition: background 0.3s;
      border: none;
      cursor: pointer;
    }

    .btn-load:hover {
      background-color: var(--accent);
    }

    /* =======================
       FOOTER
    ======================= */
    footer {
      background-color: var(--text-primary);
      color: var(--bg-color);
      padding: 0;
      text-align: center;
      margin-top: auto;
    }

    .footer-content {
      padding: 60px 20px 40px;
    }

    .social-links {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 30px;
    }

    .social-links a {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 45px;
      height: 45px;
      background-color: var(--bg-color);
      color: var(--text-primary);
      border-radius: 50%;
      font-size: 20px;
      transition: transform 0.3s, opacity 0.3s;
      text-decoration: none;
    }

    .social-links a:hover {
      transform: scale(1.1);
      opacity: 0.9;
    }

    .footer-links {
      display: flex;
      justify-content: center;
      gap: 30px;
      flex-wrap: wrap;
    }

    .footer-links a {
      color: var(--bg-color);
      text-decoration: none;
      font-size: 16px;
      transition: opacity 0.3s;
    }

    .footer-links a:hover {
      opacity: 0.8;
      text-decoration: underline;
    }

    .copyright {
      background-color: rgba(0, 0, 0, 0.2);
      font-size: 14px;
      padding: 20px;
      opacity: 0.9;
    }

    .social-links a {
      font-size: 24px;
      color: var(--bg-color);
      transition: transform 0.3s, opacity 0.3s;
    }

    .social-links a:hover {
      transform: scale(1.2);
      opacity: 1;
      text-decoration: none;
    }

    .copyright {
      font-size: 15px;
      opacity: 0.8;
      text-align: center;
    }

    @media (max-width: 860px) {
      .browse-grid {
        grid-template-columns: 1fr;
      }

      .filters {
        position: relative;
        top: 0;
      }

      header {
        padding: 20px;
        flex-direction: column;
        gap: 15px;
      }

      .nav-links {
        flex-wrap: wrap;
        justify-content: center;
      }
    }
  </style>
</head>

<body>

  <!-- HEADER -->
  <header>
    <a href="{% url 'home' %}" class="site-title">
      <i class="fa-solid fa-futbol"></i> BookMyTurf
    </a>
    <nav class="nav-links">
      <a href="{% url 'home' %}">Home</a>
      <a href="{% url 'browse_turfs' %}" class="active">Browse Turfs</a>
      {% if request.user.is_authenticated %}
      {% if request.user.role == 'owner' %}
      <a href="{% url 'owner_dashboard' %}">Dashboard</a>
      {% else %}
      <a href="{% url 'player_dashboard' %}">Dashboard</a>
      {% endif %}
      <form method="post" action="{% url 'logout' %}" style="display:inline;">
        {% csrf_token %}
        <button type="submit"
          style="background:none;border:none;color:var(--bg-color);font:inherit;cursor:pointer;font-weight:600;"><i
            class="fa-solid fa-right-from-bracket"></i> Logout</button>
      </form>
      {% else %}
      <a href="{% url 'login' %}">Login</a>
      <a href="{% url 'register_player' %}">Sign Up</a>
      {% endif %}
    </nav>
  </header>

  <div class="container">
    <h1 class="page-title">Browse Turfs</h1>
    <p class="page-subtitle">Find the perfect turf for your game in our elegant directory.</p>

    <div class="browse-grid">

      <!-- FILTERS SIDEBAR -->
      <aside class="filters">
        <h2><i class="fa-solid fa-sliders"></i> Filters</h2>

        <div class="filter-group">
          <label for="locationSelect"><i class="fa-solid fa-location-dot"></i> City/Area</label>
          <select id="locationSelect">
            <option value="all">All Locations</option>
            <option value="mumbai">Mumbai</option>
            <option value="andheri">Andheri</option>
            <option value="bandra">Bandra</option>
            <option value="powai">Powai</option>
            <option value="juhu">Juhu</option>
            <option value="thane">Thane</option>
          </select>
        </div>

        <div class="filter-group">
          <label for="priceRange"><i class="fa-solid fa-indian-rupee-sign"></i> Max Price per Hour</label>
          <input id="priceRange" type="range" min="500" max="2500" value="2500" step="100" />
          <div class="range-meta">
            <span>₹500</span>
            <span id="maxPriceText">₹2500</span>
          </div>
        </div>

        <div class="filter-actions">
          <button class="btn btn-apply" id="applyBtn"><i class="fa-solid fa-check"></i> Apply</button>
          <button class="btn btn-clear" id="clearBtn"><i class="fa-solid fa-rotate-left"></i> Clear</button>
        </div>
      </aside>

      <!-- RESULTS AREA -->
      <section class="results-area">
        <div class="results-head">
          <h3><span id="foundCount">0</span> Turfs Found</h3>
          <div class="sort-control">
            <label for="sortSelect">Sort By:</label>
            <select id="sortSelect">
              <option value="recommended" selected>Recommended</option>
              <option value="rating">Rating (High to Low)</option>
              <option value="priceLow">Price (Low to High)</option>
              <option value="priceHigh">Price (High to Low)</option>
            </select>
          </div>
        </div>

        <div class="cards-grid" id="cardsContainer">
          <!-- JS Injected Cards -->
        </div>

        <div class="load-more-container">
          <button class="btn-load" id="loadMoreBtn"><i class="fa-solid fa-rotate"></i> Load More Turfs</button>
        </div>
      </section>

    </div>
  </div>

  <!-- FOOTER -->
  <footer>
    <div class="footer-content">
      <div class="social-links">
        <a href="#" aria-label="Facebook"><i class="fa-brands fa-facebook-f"></i></a>
        <a href="#" aria-label="Instagram"><i class="fa-brands fa-instagram"></i></a>
        <a href="#" aria-label="Twitter"><i class="fa-brands fa-twitter"></i></a>
        <a href="#" aria-label="Google Plus"><i class="fa-brands fa-google-plus-g"></i></a>
        <a href="#" aria-label="YouTube"><i class="fa-brands fa-youtube"></i></a>
      </div>
      <div class="footer-links">
        <a href="{% url 'home' %}">Home</a>
        <a href="#">News</a>
        <a href="#">About</a>
        <a href="#">Contact Us</a>
        <a href="#">Our Team</a>
      </div>
    </div>
  </footer>

  <script>
    // Mock Data for Demo
    const ALL_TURFS = [
      { id: 1, name: "Green Arena", area: "Andheri W", city: "Mumbai", locationKey: "andheri", price: 800, rating: 4.8, facilities: ["parking", "lights", "shower", "wifi"] },
      { id: 2, name: "Sports Hub", area: "Bandra E", city: "Mumbai", locationKey: "bandra", price: 1200, rating: 4.6, facilities: ["parking", "lights", "cafe"] },
      { id: 3, name: "Prime Turf", area: "Powai", city: "Mumbai", locationKey: "powai", price: 1500, rating: 4.9, facilities: ["parking", "lights", "shower"] },
      { id: 4, name: "Game Zone", area: "Juhu", city: "Mumbai", locationKey: "juhu", price: 900, rating: 4.5, facilities: ["lights", "cafe", "wifi"] },
      { id: 5, name: "City Sports Arena", area: "Lower Parel", city: "Mumbai", locationKey: "mumbai", price: 1100, rating: 4.7, facilities: ["parking", "lights", "shower"] },
      { id: 6, name: "Night Play Field", area: "Andheri E", city: "Mumbai", locationKey: "andheri", price: 950, rating: 4.4, facilities: ["lights", "wifi"] },
      { id: 7, name: "Harbor KickOff", area: "Bandra W", city: "Mumbai", locationKey: "bandra", price: 1400, rating: 4.7, facilities: ["parking", "lights", "cafe", "wifi"] },
      { id: 8, name: "Lakeview Turf", area: "Powai", city: "Mumbai", locationKey: "powai", price: 1000, rating: 4.6, facilities: ["parking", "lights", "wifi"] }
    ];

    const facilityIcons = {
      parking: { icon: "fa-square-parking", title: "Parking" },
      lights: { icon: "fa-lightbulb", title: "Floodlights" },
      shower: { icon: "fa-shower", title: "Shower" },
      wifi: { icon: "fa-wifi", title: "Wi-Fi" },
      cafe: { icon: "fa-mug-hot", title: "Café" }
    };

    const state = {
      location: "all",
      maxPrice: 2500,
      sort: "recommended",
      pageSize: 6,
      shown: 0,
      filtered: []
    };

    const countEl = document.getElementById("foundCount");
    const containerEl = document.getElementById("cardsContainer");
    const loadBtn = document.getElementById("loadMoreBtn");

    function formatMoney(num) { return "₹" + num; }

    function renderCards(clear) {
      if (clear) containerEl.innerHTML = "";

      const take = Math.min(state.pageSize, state.filtered.length - state.shown);

      for (let i = 0; i < take; i++) {
        const t = state.filtered[state.shown + i];

        const facsHtml = t.facilities.map(f => `
          <div class="facility-icon" title="${facilityIcons[f].title}">
            <i class="fa-solid ${facilityIcons[f].icon}"></i>
          </div>
        `).join('');

        const cardHtml = `
          <div class="turf-card">
            <div class="turf-image-placeholder">
              <span class="badge-rating"><i class="fa-solid fa-star"></i> ${t.rating}</span>
              <i class="fa-solid fa-futbol"></i>
            </div>
            <div class="turf-details">
              <div class="turf-title">${t.name}</div>
              <div class="turf-location"><i class="fa-solid fa-location-dot"></i> ${t.area}, ${t.city}</div>
              <div class="turf-price">${formatMoney(t.price)} <span>/hour</span></div>
              <div class="facilities-list">${facsHtml}</div>
              <div class="card-actions">
                <span style="font-size:13px; font-weight:600; opacity:0.8;">Instant Book</span>
                <a href="#" class="btn-view">View <i class="fa-solid fa-arrow-right"></i></a>
              </div>
            </div>
          </div>
        `;
        containerEl.insertAdjacentHTML('beforeend', cardHtml);
      }

      state.shown += take;

      if (state.shown >= state.filtered.length) {
        loadBtn.style.display = "none";
      } else {
        loadBtn.style.display = "inline-flex";
      }
    }

    function applyFilters() {
      state.filtered = ALL_TURFS
        .filter(t => state.location === "all" || t.locationKey === state.location || t.city.toLowerCase() === state.location)
        .filter(t => t.price <= state.maxPrice);

      if (state.sort === "rating") state.filtered.sort((a, b) => b.rating - a.rating);
      if (state.sort === "priceLow") state.filtered.sort((a, b) => a.price - b.price);
      if (state.sort === "priceHigh") state.filtered.sort((a, b) => b.price - a.price);

      countEl.innerText = state.filtered.length;
      state.shown = 0;
      renderCards(true);
    }

    // Event Listeners
    document.getElementById("priceRange").addEventListener("input", (e) => {
      document.getElementById("maxPriceText").innerText = formatMoney(e.target.value);
      state.maxPrice = Number(e.target.value);
    });

    document.getElementById("applyBtn").addEventListener("click", () => {
      state.location = document.getElementById("locationSelect").value;
      state.sort = document.getElementById("sortSelect").value;
      applyFilters();
    });

    document.getElementById("clearBtn").addEventListener("click", () => {
      document.getElementById("locationSelect").value = "all";
      document.getElementById("priceRange").value = 2500;
      document.getElementById("maxPriceText").innerText = "₹2500";
      document.getElementById("sortSelect").value = "recommended";
      state.location = "all";
      state.maxPrice = 2500;
      state.sort = "recommended";
      applyFilters();
    });

    document.getElementById("sortSelect").addEventListener("change", (e) => {
      state.sort = e.target.value;
      applyFilters();
    });

    loadBtn.addEventListener("click", () => renderCards(false));

    // Init
    applyFilters();
  </script>
</body>

</html>